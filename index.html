
<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>æ„æ— åŒ</title>
    <link rel="stylesheet" href="../../static/css/mui.min.css">
    <link rel="stylesheet" href="../../static/css/sweetalert2.min.css">
    <script src="../../static/js/clipboard-v2.0.8.min.js"></script>
    <style>
        #guide {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
        }

        #guide img {
            width: 100%;
            height: 100%;
        }

        #app {
            max-width: 600px;
            margin: 0 auto;
        }

        .img-view {
            border-radius: 10px;
            overflow: hidden;
            width: 100%;
        }

        .des {
            border-radius: 5px;
            padding: 10px 15px;
            margin-top: 5px;
        }

        .des ul {
            color: rgb(3, 3, 3);
            width: 100%;
            margin: 0;
            padding: 0;
            line-height: 30px;
        }

        .install {
            display: flex;
            align-items: center;
            flex-direction: column;
            margin-bottom: 15px;
        }

        .button {
            padding: 10px;
            margin-top: 15px;
            border: none;
            width: 100%;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            color: #000 !important;
        }

        li,
        ul {
            list-style-type: none;
            font-weight: bold;
            font-size: 14px;
        }

        .des li:before {
            content: "ğŸ”¸";
            margin-right: 10px;
        }

        .red {
            color: #ff0000;
        }
    </style>
    <script src="../../static/js/jquery-1.11.1.min.js"></script>
    <script src="../../static/js/vue.global.min.js"></script>
    <script src="../../static/js/mui.min.js"></script>
    <script src="../../static/js/util.js"></script>
    <script src="../../static/js/sweetalert2.min.js"></script>
    <script>
        let headerImg = "./images/IMG_08351.jpg"; // é¡¶éƒ¨å›¾ç‰‡
        let bottomImg = "./images/IMG_0835.JPG"; // åº•éƒ¨å›¾ç‰‡
        let backgroundColor = "#0066FF"; // å…¨å±€èƒŒæ™¯
        let apiUrl1 = "./redeem.php";


        window.onload = function () {
            var userAgent = navigator.userAgent;
            if (userAgent.indexOf("MicroMessenger") !== -1 || userAgent.indexOf("QQ/") !== -1) {
                alert("å¦‚æœä½ çœ‹åˆ°æ­¤æç¤ºï¼Œå°±è¡¨ç¤ºä½ ä¸æ˜¯ä½¿ç”¨çš„è‹¹æœSafariæµè§ˆå™¨ï¼Œè¯·ä½¿ç”¨Safariæ‰“å¼€,å¦åˆ™æ— æ³•å®‰è£…");
            }
        };

        function inputCode_b(url) {
            Swal.fire({
                title: 'è¯·è¾“å…¥å…‘æ¢ç ',
                input: 'text',
                inputPlaceholder: 'è¯·è¾“å…¥æ¿€æ´»ç ',
                text: "æ¿€æ´»æˆåŠŸåè¯·ç«‹å³ä¸‹è½½å®‰è£…ï¼",
                inputAttributes: {
                    autocapitalize: 'off'
                },
                showCancelButton: true,
                confirmButtonText: 'ç¡®è®¤',
                cancelButtonText: 'å–æ¶ˆ',
                showLoaderOnConfirm: true,
                preConfirm: async (code) => {
                    try {
                        const response = await fetch(url + "?code=" + code , {
                            method: 'get',
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        });

                        const data = await response.json();

                        if (data.code === 1 && data.data.url) {
                            const redirectLink = 'itms-beta://testflight.apple.com/v1/invite/' + data.data.url;
const tfcode = data.data.tfcode;

Swal.fire({
    title: 'æ¿€æ´»æˆåŠŸï¼',
    text: 'æ¿€æ´»æˆåŠŸåè¯·3åˆ†é’Ÿå†…ä¸‹è½½å®‰è£…\nTFå…‘æ¢ç ï¼š' + tfcode,
    showConfirmButton: false,
    allowOutsideClick: false,
    footer: `
        <!-- å°†é“¾æ¥æ”¹ä¸ºæŒ‰é’®å½¢å¼ -->
        <button id="testflight-button" style="margin-top: 10px;border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em""> 
            ç‚¹å‡»è¿™é‡Œè·³è½¬è‡³TestFlight</button>
        <!-- ä¸ºå¤åˆ¶æŒ‰é’®æ·»åŠ ç‰¹å®šçš„classç”¨äºClipboard.jsè¯†åˆ« -->
        <button class="copy-tfcode-btn" data-clipboard-text="${tfcode}" style="margin-top: 10px;border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em">å¤åˆ¶TFå…‘æ¢ç </button>
    `,
    didRender: () => {
        // åˆå§‹åŒ–Clipboard.js
        var clipboard = new ClipboardJS('.copy-tfcode-btn');
        // è·³è½¬TestFlightæŒ‰é’®ç‚¹å‡»äº‹ä»¶
        document.getElementById('testflight-button').addEventListener('click', () => {
            window.location.href = redirectLink; // æˆ–ä½¿ç”¨window.open(redirectLink)åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
        });
        // ç›‘å¬å¤åˆ¶æˆåŠŸäº‹ä»¶
        clipboard.on('success', function(e) {
            console.log('å¤åˆ¶æˆåŠŸï¼');
            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æˆåŠŸå¤åˆ¶çš„UIåé¦ˆï¼Œå¦‚å¼¹çª—æç¤º
            Swal.fire('æˆåŠŸ', 'TFå…‘æ¢ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            e.clearSelection(); // æ¸…é™¤é€‰ä¸­çŠ¶æ€
        });

        // ç›‘å¬å¤åˆ¶å¤±è´¥äº‹ä»¶
        clipboard.on('error', function(e) {
            console.error('æ— æ³•å¤åˆ¶æ–‡æœ¬: ', e);
            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å¤åˆ¶å¤±è´¥çš„UIåé¦ˆ
            Swal.fire('é”™è¯¯', 'å¤åˆ¶TFå…‘æ¢ç å‡ºé”™', 'error');
        });
    },
});
                        } else {
                            Swal.showValidationMessage(data.msg || 'æ¿€æ´»å¤±è´¥ï¼Œè¯·é‡è¯•');
                        }
                    } catch (e) {
                        Swal.showValidationMessage('æ¿€æ´»å¤±è´¥ï¼Œè¯·é‡è¯•');
                    }
                },
                allowOutsideClick: () => !Swal.isLoading()
            });
        }
    </script>
</head>

<body>
    <div id="app">
        <style type="text/css" media="all">
            .content-am {
                background-color: #f2ba03;
            }
        </style>
        <n-config-provider :theme-overrides="{ common: { primaryColor: am } }">
            <n-spin :show="loading">
                <img class="img-view header-img" :src="../../static/picture/dce3a13332b642ad8bfad8ba26c802c4.gif" alt="">
                <n-alert title="" v-show="loading" type="success">
                    æ­£åœ¨è·å–é“¾æ¥,è¯·ç¨ç­‰...
                </n-alert>
                <div class="des" :style="{ backgroundColor: am }">
                    <ul>
                        <li>å®Œç¾è½¬å‘ è¶…çº§é˜²å° ç•…çˆ½ä½¿ç”¨</li>
                        <li>ä¸€ä¸ªæ¿€æ´»ç å¯åœ¨ä¸€ä¸ªè®¾å¤‡ä¸Š <span class="red">ä¸€å¼€</span></li>
                        <li>ä¸€ä¸ªæ¿€æ´»ç ä¸å¯ç”¨åœ¨å…¶ä»–è®¾å¤‡</li>
                        <li>ä¸€ä¸ªæ¿€æ´»ç å¯ä»¥ä¸‹è½½<span class="red">ä¸€æ¬¡</span></li>
                        <li><span class="red">ä¸€ç ä¸€å¼€,éœ€è¦æ›´å¤šå¼€è¯·ä½¿ç”¨å¤šä¸ªæ¿€æ´»ç ï¼</span></li>
                        <li>å®‰è£…ç•Œé¢è¿‡æœŸæ—¶é—´ä¸ç”¨æˆ·æ— å…³,è¯·æ”¾å¿ƒä½¿ç”¨ï¼</li>
                    </ul>
                </div>
                <div class="install">
                    <button class="button content-am" @click="installTf" :style="{ backgroundColor: am }">æ­¥éª¤ä¸€ â†’ã€å®‰è£…TestFlightã€‘</button>
                    <button class="button content-am" @click="inputCode(to1)" :style="{ backgroundColor: am }">æ­¥éª¤äºŒ â†’ã€TFå®‰è£… æ„æ— åŒã€‘</button>
<!--
                    <button class="button content-am" @click="redirectToLink" :style="{ backgroundColor: am }">å¤‡ç”¨å®‰è£…åœ°å€</button>
                    -->
                </div>
            </n-spin>
        </n-config-provider>
        <img class="img-view header-img" :src="../../static/picture/519f9bb69ed343788f2acecafebbfb72.gif" alt="">
    </div>

    <script>
        const { createApp } = Vue;

        const app = createApp({
            data() {
                return {
                    appName: "æ˜Ÿæ²³",
                    headerImg: headerImg,
                    bottomImg: bottomImg,
                    am: backgroundColor,
                    to1: apiUrl1 || window.location.pathname,
                    loading: false
                };
            },
            methods: {
                installTf() {
                    window.open("https://apps.apple.com/cn/app/testflight/id899247664");
                },
                inputCode(url) {
                    inputCode_b(url);
                },
                redirectToLink() {
                    window.open("", "_blank");
                }
            }
        }).mount('#app');
    </script>

    <div id="guide">
        <img src="../../static/picture/guide.png" alt="å¼•å¯¼å›¾ç‰‡">
    </div>
</body>

</html>
